install.packages("multiwayvcov")
# load packages ----
library(tidyverse)
library(lmtest)
library(multiwayvcov)
library(ggpubr)
# get data ----
df <- haven::read_dta("./data/PES_data_public.dta")
# preparatory subsetting
df <- df %>% filter(sample_gps==1)
df <- df %>% mutate(
change_fcover_vil = end_fcover_vil - base_fcover_vil,
log_change_fcover_vil = log(end_fcover_vil) - log(base_fcover_vil)
)
############################################################################
# Task 2
# run linear regression for model 1 in table 3
tab3_mod1 <- lm(change_fcover_vil~treatstat_vil
# + num_PFOs_vil # not found
# + inc_pc_vil # not found
+ dist_road
+ l1_area
+ as.factor(subcounty),
df
)
summary(tab3_mod1, vcov=function(x) cluster.vcov(tab3_mod1, df[, "village"]))
# To calculate the average tree cover change for the control group we can compute
df %>% filter(treatstat_vil=="Control") %>% summarise(MeanForestCoverChange = weighted.mean(change_fcover_vil, SPct_Data_vil))
tab3_mod3 <- lm(log_change_fcover_vil~treatstat_vil
# + num_PFOs_vil # not found
# + inc_pc_vil # not found
+ dist_road
+ l1_area
+ photo1991_act
+ photo2011_act
# + pfo_satdate_* # not found
+ as.factor(subcounty),
df
)
summary(tab3_mod3, vcov=function(x) cluster.vcov(tab3_mod3, df[, "village"]))
tab3_mod2 <- lm(change_fcover_vil~treatstat_vil
# + num_PFOs_vil # not found
# + inc_pc_vil # not found
+ dist_road
+ l1_area
+ photo1991_act
+ photo2011_act
# + pfo_satdate_* # not found
+ as.factor(subcounty),
df
)
summary(tab3_mod2, vcov=function(x) cluster.vcov(tab3_mod2, df[, "village"]))
# plot the data in box plot
plot1 <- ggboxplot(df, x = "treatstat_vil", y = "change_fcover_vil",
color = "treatstat_vil", palette = "lancet",
add = "jitter", title = "Effect of PES on forest cover",
xlab = "Treatment status", ylab = "Change in forest cover")
#  Add p-value
plot1 + stat_compare_means(method = "t.test") + rremove("legend")
# calculate a t-test to compare the means
t.test(change_fcover_vil~treatstat_vil, data = df)
# Additional plots
# plotting a density plot
ggdens <- ggdensity(df, x = "change_fcover_vil",
add = "mean", rug = TRUE,
color = "treatstat_vil", fill = "treatstat_vil",
palette = "lancet")
# plotting a histogram
gghist <- gghistogram(df, x = "change_fcover_vil",
add = "mean", rug = TRUE,
color = "treatstat_vil", fill = "treatstat_vil",
palette = "lancet", bins=100)
cowplot::plot_grid(ggdens, gghist, nrow = 1)
